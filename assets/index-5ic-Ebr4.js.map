{"version":3,"file":"index-5ic-Ebr4.js","sources":["../../src/util.js","../../src/main.js"],"sourcesContent":["export const compareObjects = (a, b) => {\n    if (a === b) return true;\n\n    if (typeof a != 'object' || typeof b != 'object' || a == null || b == null) return false;\n\n    let keysA = Object.keys(a), keysB = Object.keys(b);\n\n    if (keysA.length != keysB.length) return false;\n\n    for (let key of keysA) {\n        if (!keysB.includes(key)) return false;\n\n        if (typeof a[key] === 'function' || typeof b[key] === 'function') {\n            if (a[key].toString() != b[key].toString()) return false;\n        } else {\n            if (!compareObjects(a[key], b[key])) return false;\n        }\n    }\n\n    return true;\n}\n","import {\n    compareObjects\n} from \"./util\";\n\nimport kaplay from \"kaplay\";\nimport \"kaplay/global\"; // uncomment if you want to use without the k. prefix\n\n// kaplay();\nkaplay({\n    width: 480,\n    height: 432,\n    background: [0, 0, 255,],\n    scale: 1.5\n})\n// loadRoot(\"./\"); // A good idea for Itch.io publishing later\n\n//load sprites first\nloadSprite(\"bean\", \"./sprites/bean.png\");\nloadSprite(\"grassbackground\", \"./sprites/cowbackground.png\");\nloadSprite(\"plainbackground\", \"./sprites/plainbackground.png\");\nloadSprite(\"cyanmilk\", \"./sprites/cyanmilk.png\"); \nloadSprite(\"magentamilk\", \"./sprites/magentamilk.png\");\nloadSprite(\"yellowmilk\", \"./sprites/yellowmilk.png\");\nloadSprite(\"keymilk\", \"./sprites/keymilk.png\");\nloadSprite(\"title\", \"./sprites/title.png\");\nloadAseprite(\"cow\",\"./sprites/cowsprite.png\", \"./sprites/cowsprite.json\");\nloadAseprite(\"conveyor\", \"./sprites/conveyorbelt.png\", \"./sprites/conveyorbelt.json\");\nloadAseprite(\"splat\", \"./sprites/splat.png\", \"./sprites/splat.json\");\nloadMusic(\"bgm\", \"./sprites/VillageSongWAV.wav\");\nloadSound(\"cowjumpsfx\", \"./sprites/cowjumpsfx.mp3\");\nloadSound(\"cowsplatsfx\", \"./sprites/cowsplatsfx.mp3\");\nloadSound(\"cowmoosfx\", \"./sprites/cowmoosfx.mp3\");\n\n\nscene(\"start\", () => {\n    add([ sprite(\"title\"), ]);\n    onClick(() => go(\"game\"));\n    onKeyPress(\"space\", () => go(\"game\"));\n    onTouchStart(() => go(\"game\"));\n});\n\n\nscene(\"game\", () => {\n    add([ sprite(\"grassbackground\"), ]);\n\n    setGravity(1650);\n\n    const music = play(\"bgm\",{\n        music: true,\n        volume: 0.5,\n        loop: true,\n    })\n\n    // player\n    const cowplayer = add([\n        sprite(\"cow\", {\n            anim: \"walk\",\n        }),\n        scale(0.9),\n        pos(60, 0),\n        area(),\n        body(),\n        anchor(\"center\"),\n        animate(), \n    ]);\n\n    // platform floor\n    add([\n        sprite(\"conveyor\", {\n            anim: \"convey\",\n        }), \n        pos(0, height() - 48),\n        outline(4),\n        area(),\n        body({ isStatic: true }),\n        animate(),\n        \"conveyor\",\n    ]);\n\n    //cowplayer movement - spacebar to jump\n    onKeyPress(\"space\", () => {\n        if (cowplayer.isGrounded()) {\n            play(\"cowjumpsfx\", {\n                volume: 0.7,\n            });\n            cowplayer.jump();\n            cowplayer.play(\"jump\");\n        }\n    });\n    //cowplayer movement - left click to jump\n    onClick(() => {\n        if (cowplayer.isGrounded()) {\n            play(\"cowjumpsfx\", {\n                volume: 0.7,           \n            });\n            cowplayer.jump();\n            cowplayer.play(\"jump\");\n        }\n    });\n    onTouchStart(() => {\n        if (cowplayer.isGrounded()) {\n            play(\"cowjumpsfx\", {\n                volume: 0.7,           \n            });\n            cowplayer.jump();\n            cowplayer.play(\"jump\");\n        }\n    });\n\n    // wanted milk box\n    const match = add([\n        choose([\n            sprite(\"yellowmilk\"), \n            sprite(\"cyanmilk\"), \n            sprite(\"magentamilk\"), \n            sprite(\"keymilk\")\n        ]),\n        pos(340,24),\n        \"match\"\n    ])\n\n\n    // scores and other variables\n    let score = 0;\n    let isNowBeef = false;\n    const scoreLabel = add([text(score), pos(8, 8),]);\n    scoreLabel.color = rgb(189, 154, 120);\n    let max = 4;\n\n    // spawn obstacles, destroy them offscreen, update score\n    function spawnBox() {\n        max -= 0.1;\n        const box = add([\n            choose([\n                sprite(\"yellowmilk\"), \n                sprite(\"cyanmilk\"), \n                sprite(\"magentamilk\"), \n                sprite(\"keymilk\")\n            ]),\n            area(),\n            pos(width(), height() - 48),\n            anchor(\"botleft\"),\n            move(LEFT, 240),\n            offscreen(), \n            \"obstacle\",\n        ]);\n\n        // if player dodges box and it moves off screen\n        box.onUpdate(() => {\n            if(box.pos.x <= 0 && !isNowBeef) {\n                box.destroy();\n                score++;\n                scoreLabel.text = score\n            }\n        });\n\n        if (max <= 1){\n            max = 3;    \n        }\n\n        wait(rand(1, max), () => {\n            spawnBox();\n        });\n    }\n    spawnBox();\n\n    // collision detection - if cow hits box\n    cowplayer.onCollide(\"obstacle\", (obstacle) => {\n        if (compareObjects(obstacle.sprite, match.sprite)) {\n            play(\"cowmoosfx\", {\n                volume: 0.7,\n            });\n            score += 100;\n            scoreLabel.text = score;\n            obstacle.destroy(); \n        } else {\n            music.paused = true;\n            play(\"cowsplatsfx\", {\n                volume: 0.7,           \n            });\n            destroy(cowplayer);\n            const milklose = add([\n                sprite(\"splat\", { anim: \"splatter\",}),\n                anchor(\"center\"), \n            ]);\n            milklose.pos = cowplayer.pos;\n            shake();\n            isNowBeef = true;\n            wait(0.8, () => {\n                // loser\n                if (localStorage.getItem(\"user\")){\n                    go(\"lose\", score);\n                } else {\n                    go(\"username\",score)\n                }\n                \n            });\n        }\n    });\n\n    // cowplayer platform walk animation\n    cowplayer.onCollide(\"conveyor\", () => {\n        cowplayer.play(\"walk\");\n    });\n})\n\nscene(\"username\", (score) => {\n\n    // check if localStorage.getItem(\"user\") is true or not in game scene\n    let username = localStorage.getItem(\"user\");\n    add([ sprite(\"plainbackground\"), pos(0, 0),]);\n    add([text(\"Type your name and press enter\"), pos(width()/2,height()/2 - 50), scale(0.5), anchor(\"center\"), color(0,0,0)]);\n    const obj = add([   \n        text(\"______\"),\n        textInput(),\n        pos(width()/2, height()/2),\n        anchor(\"center\"),\n        scale(0.5),\n    ])\n\n    obj.hasFocus = true\n    obj.onInput(()=>{\n        console.log(obj.typedText)\n        localStorage.setItem(\"user\", obj.typedText)\n        username = obj.typedText\n    })\n\n    // add([text(username), pos(width()/2,60), scale(1.3), anchor(\"center\"), color(0,0,0)]);\n    onKeyPress(\"enter\", () => go(\"lose\",score))\n\n})\n\nscene(\"lose\", (score) => {\n    // localstorage here\n    let highscore = localStorage.getItem(\"high\");\n    if (highscore && score > highscore) {\n        localStorage.setItem(\"high\", score);\n        highscore = score;\n    }\n\n    if(!highscore) {\n        localStorage.setItem(\"high\", score);\n        highscore = score;\n    }\n    console.log(highscore)\n    \n\n    add([ sprite(\"plainbackground\"), pos(0, 0),]);\n    add([text(\"Game Over\"), pos(width()/2,30), scale(1.3), anchor(\"center\"), color(0,0,0)]);\n    add([text(\"Highscores\"), pos(width() / 2, 80), anchor(\"center\"), scale(0.6), color(0,0,0)]);\n    add([text(localStorage.getItem(\"user\") + \" - \" + (highscore || 0)), pos(width() / 2, 120), anchor(\"center\"), scale(0.6), color(50,50,50)]);\n\n    add([text(\"Score: \" + score ), pos(width() / 2, height() / 2 + 150), anchor(\"center\"), scale(0.6), color(255,255,219)]);\n    add([text(\"Click to Restart\"), pos(width() / 2, height() / 2 + 180), anchor(\"center\"), scale(0.6), color(255,255,219)]);\n    onClick(() => go(\"game\"));\n    onKeyPress(\"space\", () => go(\"game\")); \n});\n\ngo(\"start\");"],"names":["compareObjects","a","b","keysA","keysB","key","kaplay","music","cowplayer","match","score","isNowBeef","scoreLabel","max","spawnBox","box","obstacle","milklose","obj","highscore"],"mappings":"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"}